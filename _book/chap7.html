<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 LinearModels | BIOL3360</title>
  <meta name="description" content="7 LinearModels | BIOL3360" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="7 LinearModels | BIOL3360" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 LinearModels | BIOL3360" />
  
  
  

<meta name="author" content="Simone Blomberg" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap6.html"/>
<link rel="next" href="chap8.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="pics/favicon.ico">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://shire.science.uq.edu.au/QBIOL/">QBIO Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to BIOL3360!</a></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> BIOL3360: Analysis and Communication of Biological Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#course-description"><i class="fa fa-check"></i><b>1.1</b> Course description</a></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#course-delivery"><i class="fa fa-check"></i><b>1.2</b> Course Delivery</a></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#textbooks-and-resources"><i class="fa fa-check"></i><b>1.3</b> Textbooks and Resources</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#assessment"><i class="fa fa-check"></i><b>1.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5" data-path="chap1.html"><a href="chap1.html#goals-and-expectations"><i class="fa fa-check"></i><b>1.5</b> Goals and expectations</a></li>
<li class="chapter" data-level="1.6" data-path="chap1.html"><a href="chap1.html#course-communication"><i class="fa fa-check"></i><b>1.6</b> Course communication</a></li>
<li class="chapter" data-level="1.7" data-path="chap1.html"><a href="chap1.html#and-finally"><i class="fa fa-check"></i><b>1.7</b> And finally…</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> Week 1: R Programming I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#why-programming-why-statistics-why-r"><i class="fa fa-check"></i><b>2.1</b> Why Programming? Why Statistics? Why R?</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#why-statistics"><i class="fa fa-check"></i><b>2.2</b> Why Statistics?</a></li>
<li class="chapter" data-level="2.3" data-path="chap2.html"><a href="chap2.html#why-r"><i class="fa fa-check"></i><b>2.3</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> Beginning R Programming</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#the-workspace-setup"><i class="fa fa-check"></i><b>3.1</b> The Workspace Setup</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#first-steps"><i class="fa fa-check"></i><b>3.2</b> First steps</a></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#the-art-of-r-programming"><i class="fa fa-check"></i><b>3.3</b> The Art of R Programming</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> More R Programming</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#data-structures"><i class="fa fa-check"></i><b>4.1</b> Data Structures</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#lists"><i class="fa fa-check"></i><b>4.2</b> Lists</a></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> Flow of Control</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#loops"><i class="fa fa-check"></i><b>5.1</b> Loops</a></li>
<li class="chapter" data-level="5.2" data-path="chap5.html"><a href="chap5.html#for-loops"><i class="fa fa-check"></i><b>5.2</b> For loops</a></li>
<li class="chapter" data-level="5.3" data-path="chap5.html"><a href="chap5.html#while-and-repeat"><i class="fa fa-check"></i><b>5.3</b> while and repeat</a></li>
<li class="chapter" data-level="5.4" data-path="chap5.html"><a href="chap5.html#branching-code-the-if-then-else-construct."><i class="fa fa-check"></i><b>5.4</b> Branching code: The if-then-else construct.</a></li>
<li class="chapter" data-level="5.5" data-path="chap5.html"><a href="chap5.html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap6.html"><a href="chap6.html#some-history"><i class="fa fa-check"></i><b>6.1</b> Some History</a></li>
<li class="chapter" data-level="6.2" data-path="chap6.html"><a href="chap6.html#experiments"><i class="fa fa-check"></i><b>6.2</b> Experiments</a></li>
<li class="chapter" data-level="6.3" data-path="chap6.html"><a href="chap6.html#more-terminology"><i class="fa fa-check"></i><b>6.3</b> More terminology</a></li>
<li class="chapter" data-level="6.4" data-path="chap6.html"><a href="chap6.html#randomness"><i class="fa fa-check"></i><b>6.4</b> Randomness</a></li>
<li class="chapter" data-level="6.5" data-path="chap6.html"><a href="chap6.html#positive-and-negative-controls"><i class="fa fa-check"></i><b>6.5</b> Positive and Negative Controls</a></li>
<li class="chapter" data-level="6.6" data-path="chap6.html"><a href="chap6.html#blinding-of-experiments"><i class="fa fa-check"></i><b>6.6</b> Blinding of experiments</a></li>
<li class="chapter" data-level="6.7" data-path="chap6.html"><a href="chap6.html#covariates"><i class="fa fa-check"></i><b>6.7</b> Covariates</a></li>
<li class="chapter" data-level="6.8" data-path="chap6.html"><a href="chap6.html#natural-experiments-or-natural-experiments"><i class="fa fa-check"></i><b>6.8</b> “Natural” Experiments or Natural “Experiments”</a></li>
<li class="chapter" data-level="6.9" data-path="chap6.html"><a href="chap6.html#random-effects-and-blocking"><i class="fa fa-check"></i><b>6.9</b> Random effects and Blocking</a></li>
<li class="chapter" data-level="6.10" data-path="chap6.html"><a href="chap6.html#power"><i class="fa fa-check"></i><b>6.10</b> Power</a></li>
<li class="chapter" data-level="6.11" data-path="chap6.html"><a href="chap6.html#factors-affecting-the-power-of-a-test"><i class="fa fa-check"></i><b>6.11</b> Factors affecting the Power of a Test</a></li>
<li class="chapter" data-level="6.12" data-path="chap6.html"><a href="chap6.html#built-in-r-functions-for-power-analysis"><i class="fa fa-check"></i><b>6.12</b> Built-in R Functions for Power Analysis</a></li>
<li class="chapter" data-level="6.13" data-path="chap6.html"><a href="chap6.html#power-of-the-t-test"><i class="fa fa-check"></i><b>6.13</b> Power of the t-test</a></li>
<li class="chapter" data-level="6.14" data-path="chap6.html"><a href="chap6.html#exercises"><i class="fa fa-check"></i><b>6.14</b> Exercises</a></li>
<li class="chapter" data-level="6.15" data-path="chap6.html"><a href="chap6.html#package-pwr"><i class="fa fa-check"></i><b>6.15</b> Package <tt>pwr</tt></a></li>
<li class="chapter" data-level="6.16" data-path="chap6.html"><a href="chap6.html#exercises-1"><i class="fa fa-check"></i><b>6.16</b> Exercises</a></li>
<li class="chapter" data-level="6.17" data-path="chap6.html"><a href="chap6.html#effect-sizes"><i class="fa fa-check"></i><b>6.17</b> Effect Sizes</a></li>
<li class="chapter" data-level="6.18" data-path="chap6.html"><a href="chap6.html#exercises-2"><i class="fa fa-check"></i><b>6.18</b> Exercises</a></li>
<li class="chapter" data-level="6.19" data-path="chap6.html"><a href="chap6.html#power-curves"><i class="fa fa-check"></i><b>6.19</b> Power Curves</a></li>
<li class="chapter" data-level="6.20" data-path="chap6.html"><a href="chap6.html#power-analysis-by-simulation"><i class="fa fa-check"></i><b>6.20</b> Power Analysis by Simulation</a></li>
<li class="chapter" data-level="6.21" data-path="chap6.html"><a href="chap6.html#exercise"><i class="fa fa-check"></i><b>6.21</b> Exercise</a></li>
<li class="chapter" data-level="6.22" data-path="chap6.html"><a href="chap6.html#references"><i class="fa fa-check"></i><b>6.22</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap7.html"><a href="chap7.html"><i class="fa fa-check"></i><b>7</b> LinearModels</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap7.html"><a href="chap7.html#graphing-the-iris-data"><i class="fa fa-check"></i><b>7.1</b> Graphing the Iris data</a></li>
<li class="chapter" data-level="7.2" data-path="chap7.html"><a href="chap7.html#good-resources-for-graphing"><i class="fa fa-check"></i><b>7.2</b> Good Resources for Graphing</a></li>
<li class="chapter" data-level="7.3" data-path="chap7.html"><a href="chap7.html#analysing-the-iris-data"><i class="fa fa-check"></i><b>7.3</b> Analysing the iris data</a></li>
<li class="chapter" data-level="7.4" data-path="chap7.html"><a href="chap7.html#model-diagnostics"><i class="fa fa-check"></i><b>7.4</b> Model Diagnostics</a></li>
<li class="chapter" data-level="7.5" data-path="chap7.html"><a href="chap7.html#analysis-using-t-test"><i class="fa fa-check"></i><b>7.5</b> Analysis using t test</a></li>
<li class="chapter" data-level="7.6" data-path="chap7.html"><a href="chap7.html#analysis-using-anova"><i class="fa fa-check"></i><b>7.6</b> Analysis using ANOVA</a></li>
<li class="chapter" data-level="7.7" data-path="chap7.html"><a href="chap7.html#analysis-using-regression"><i class="fa fa-check"></i><b>7.7</b> Analysis using Regression</a></li>
<li class="chapter" data-level="7.8" data-path="chap7.html"><a href="chap7.html#points-to-note"><i class="fa fa-check"></i><b>7.8</b> Points to Note</a></li>
<li class="chapter" data-level="7.9" data-path="chap7.html"><a href="chap7.html#summary"><i class="fa fa-check"></i><b>7.9</b> Summary</a></li>
<li class="chapter" data-level="7.10" data-path="chap7.html"><a href="chap7.html#linear-models"><i class="fa fa-check"></i><b>7.10</b> Linear Models</a></li>
<li class="chapter" data-level="7.11" data-path="chap7.html"><a href="chap7.html#matrix-notation-for-linear-models"><i class="fa fa-check"></i><b>7.11</b> Matrix Notation for Linear Models</a></li>
<li class="chapter" data-level="7.12" data-path="chap7.html"><a href="chap7.html#matrix-representation"><i class="fa fa-check"></i><b>7.12</b> Matrix Representation</a></li>
<li class="chapter" data-level="7.13" data-path="chap7.html"><a href="chap7.html#distributional-assumptions"><i class="fa fa-check"></i><b>7.13</b> Distributional Assumptions</a></li>
<li class="chapter" data-level="7.14" data-path="chap7.html"><a href="chap7.html#estimation-ordinary-least-squares"><i class="fa fa-check"></i><b>7.14</b> Estimation: Ordinary Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap8.html"><a href="chap8.html"><i class="fa fa-check"></i><b>8</b> Generalised Least Squares</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chap8.html"><a href="chap8.html#estimation-gls"><i class="fa fa-check"></i><b>8.1</b> Estimation: GLS</a></li>
<li class="chapter" data-level="8.2" data-path="chap8.html"><a href="chap8.html#gls-example-phylogenetic-autocorrelation"><i class="fa fa-check"></i><b>8.2</b> GLS example: Phylogenetic autocorrelation</a></li>
<li class="chapter" data-level="8.3" data-path="chap8.html"><a href="chap8.html#gls-example-phylogenetic-autocorrelation-1"><i class="fa fa-check"></i><b>8.3</b> GLS example: Phylogenetic autocorrelation</a></li>
<li class="chapter" data-level="8.4" data-path="chap8.html"><a href="chap8.html#gls-example-time-series"><i class="fa fa-check"></i><b>8.4</b> GLS example: Time Series</a></li>
<li class="chapter" data-level="8.5" data-path="chap8.html"><a href="chap8.html#lynx-data"><i class="fa fa-check"></i><b>8.5</b> Lynx Data</a></li>
<li class="chapter" data-level="8.6" data-path="chap8.html"><a href="chap8.html#acf-and-pacf"><i class="fa fa-check"></i><b>8.6</b> ACF and PACF</a></li>
<li class="chapter" data-level="8.7" data-path="chap8.html"><a href="chap8.html#autoregression-of-lynx-data"><i class="fa fa-check"></i><b>8.7</b> Autoregression of Lynx Data</a></li>
<li class="chapter" data-level="8.8" data-path="chap8.html"><a href="chap8.html#gls-autoregression-model-of-lynx-data"><i class="fa fa-check"></i><b>8.8</b> GLS Autoregression model of Lynx data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap9.html"><a href="chap9.html"><i class="fa fa-check"></i><b>9</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap9.html"><a href="chap9.html#types-of-data"><i class="fa fa-check"></i><b>9.1</b> Types of Data</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html"><i class="fa fa-check"></i><b>10</b> Multinomial Experiments</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#pearsons-x2-test"><i class="fa fa-check"></i><b>10.1</b> Pearson’s <span class="math inline">\(X^2\)</span> test</a></li>
<li class="chapter" data-level="10.2" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#example-1.-specified-cell-probabilities"><i class="fa fa-check"></i><b>10.2</b> Example 1. Specified Cell Probabilities</a></li>
<li class="chapter" data-level="10.3" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#example-2-goodness-of-fit"><i class="fa fa-check"></i><b>10.3</b> Example 2: Goodness-of-fit</a></li>
<li class="chapter" data-level="10.4" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#example-3-contingency-tables"><i class="fa fa-check"></i><b>10.4</b> Example 3: Contingency Tables</a></li>
<li class="chapter" data-level="10.5" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#assumptions-of-the-x2-test"><i class="fa fa-check"></i><b>10.5</b> Assumptions of the <span class="math inline">\(X^2\)</span> Test</a></li>
<li class="chapter" data-level="10.6" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#loglinear-models"><i class="fa fa-check"></i><b>10.6</b> Loglinear Models</a></li>
<li class="chapter" data-level="10.7" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#generalised-linear-models"><i class="fa fa-check"></i><b>10.7</b> Generalised Linear Models</a></li>
<li class="chapter" data-level="10.8" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#the-general-linear-model-for-normal-responses"><i class="fa fa-check"></i><b>10.8</b> The General Linear Model for Normal Responses</a></li>
<li class="chapter" data-level="10.9" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#the-poisson-glm"><i class="fa fa-check"></i><b>10.9</b> The Poisson GLM</a></li>
<li class="chapter" data-level="10.10" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#fitting-the-poisson-glm"><i class="fa fa-check"></i><b>10.10</b> Fitting the Poisson GLM</a></li>
<li class="chapter" data-level="10.11" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#mode-diagnostics"><i class="fa fa-check"></i><b>10.11</b> Mode Diagnostics</a></li>
<li class="chapter" data-level="10.12" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#the-binomial-glm"><i class="fa fa-check"></i><b>10.12</b> The Binomial GLM</a></li>
<li class="chapter" data-level="10.13" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#example-beetle-mortality-to-insecticide"><i class="fa fa-check"></i><b>10.13</b> Example: Beetle mortality to insecticide</a></li>
<li class="chapter" data-level="10.14" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#diagnostics"><i class="fa fa-check"></i><b>10.14</b> Diagnostics</a></li>
<li class="chapter" data-level="10.15" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#another-approach-to-diagnostics"><i class="fa fa-check"></i><b>10.15</b> Another approach to Diagnostics</a></li>
<li class="chapter" data-level="10.16" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#some-theory"><i class="fa fa-check"></i><b>10.16</b> Some theory</a></li>
<li class="chapter" data-level="10.17" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#simple-example-the-poisson-distribution"><i class="fa fa-check"></i><b>10.17</b> Simple example: The Poisson distribution</a></li>
<li class="chapter" data-level="10.18" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#the-binomial-distribution-in-exponential-form"><i class="fa fa-check"></i><b>10.18</b> The Binomial distribution in exponential form</a></li>
<li class="chapter" data-level="10.19" data-path="multinomial-experiments.html"><a href="multinomial-experiments.html#issues-when-fitting-with-glms"><i class="fa fa-check"></i><b>10.19</b> Issues when fitting with GLMs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL3360</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap7" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> LinearModels<a href="chap7.html#chap7" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Consider R. A. Fisher’s classic Iris data set, consisting of several morphological measurements on the flowers of three species of <em>Iris</em>. This data set is famous in statistics and is often used as test data for a wide variety of statistical methods. Fisher was probably the most important statistician <strong>and</strong> evolutionary biologist of the 20th century. He layed the foundations for our modern practice of statistics and he was a great evolutionary geneticist, partly responsible for inventing population genetics and establishing that natural selection could indeed be a powerful force in evolution. He was also a terrible grump and had lots of fights with other scientists. Although I like to find out about my idols, Fisher is someone that I am glad not to have met! Back to the data:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chap7.html#cb62-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;sepalsPetals.jpg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-32"></span>
<img src="sepalsPetals.jpg" alt="An Iris" width="108" />
<p class="caption">
Figure 7.1: An Iris
</p>
</div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="chap7.html#cb63-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;fisher-smiling-50.jpg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="fisher-smiling-50.jpg" alt="R. A. Fisher" width="100" />
<p class="caption">
Figure 7.2: R. A. Fisher
</p>
</div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chap7.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb64-2"><a href="chap7.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="chap7.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width
## 145          6.7         3.3          5.7         2.5
## 146          6.7         3.0          5.2         2.3
## 147          6.3         2.5          5.0         1.9
## 148          6.5         3.0          5.2         2.0
## 149          6.2         3.4          5.4         2.3
## 150          5.9         3.0          5.1         1.8
##       Species
## 145 virginica
## 146 virginica
## 147 virginica
## 148 virginica
## 149 virginica
## 150 virginica</code></pre>
<p>Here we have loaded the data frame called <code>iris</code> It is built into R, which is convenient for us. The <code>head()</code> and <code>tail()</code> functions examine the first 6 and the last 6 lines of the data frame, allowing us to see the variable names and check that the data frame is usable. Although</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="chap7.html#cb68-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;Kosaciec_szczecinkowaty_Iris_setosa.jpg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="Kosaciec_szczecinkowaty_Iris_setosa.jpg" alt="Iris setosa" width="110" />
<p class="caption">
Figure 7.3: Iris setosa
</p>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="chap7.html#cb69-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;220px-Iris_virginica.jpg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="220px-Iris_virginica.jpg" alt="Iris virginica" width="110" />
<p class="caption">
Figure 7.4: Iris virginica
</p>
</div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="chap7.html#cb70-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;220px-Iris_versicolor_3.jpg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="220px-Iris_versicolor_3.jpg" alt="Iris versicolor" width="110" />
<p class="caption">
Figure 7.5: Iris versicolor
</p>
</div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="chap7.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length  
##  Min.   :4.300   Min.   :2.000   Min.   :1.000  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600  
##  Median :5.800   Median :3.000   Median :4.350  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900  
##   Petal.Width          Species  
##  Min.   :0.100   setosa    :50  
##  1st Qu.:0.300   versicolor:50  
##  Median :1.300   virginica :50  
##  Mean   :1.199                  
##  3rd Qu.:1.800                  
##  Max.   :2.500</code></pre>
<p>Here we have a six-figure summary of each of the variables: the mean, minimum and maximum values, plus the median, and first and 3rd quartiles. Together these numbers tell us a little about the distribution of the data (but not much).</p>
<div id="graphing-the-iris-data" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Graphing the Iris data<a href="chap7.html#graphing-the-iris-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="chap7.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb73-2"><a href="chap7.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Petal.Length), <span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb73-3"><a href="chap7.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span></code></pre></div>
<p><img src="BIOL3360_files/figure-html/unnamed-chunk-39-1.png" width="360" />
Here we have a plot of the Petal Length for each species. The dots overlap a lot and it is hard to see what is going on, although you can see the maxima and minima quite clearly for each species.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="chap7.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Petal.Length), <span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb74-2"><a href="chap7.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span></code></pre></div>
<p><img src="BIOL3360_files/figure-html/unnamed-chunk-40-1.png" width="360" />
Here are the same data but we have “jittered” the data along the x-axis, allowing us to see each data point separately from the others. This is a good way to display small amounts of data. Note that you should only jitter the data in the x direction in this case. Jittering the y data is wrong! (why?)</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="chap7.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Petal.Length), <span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb75-2"><a href="chap7.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span></code></pre></div>
<p><img src="BIOL3360_files/figure-html/unnamed-chunk-41-1.png" width="360" /></p>
<p>If we have a larger amount of data, a box and whisker plot can be useful. It plots the median and interquartile range, and the outer <code>whiskers</code> extend to 1.5 x the size of the interquartile range. Extreme outliers are also indicated.</p>
</div>
<div id="good-resources-for-graphing" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Good Resources for Graphing<a href="chap7.html#good-resources-for-graphing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We won’t have much time to go into advanced graphing techniques in this course, although I will try to highlight graphing methods as we go along. Fortunately, there are some good books to consult. They are online through the library:</p>
<ul>
<li><em>R Graphics Cookbook</em> by Chang</li>
<li><em>ggplot2 Elegant Graphics for Data Analysis</em> by Wickham</li>
</ul>
</div>
<div id="analysing-the-iris-data" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Analysing the iris data<a href="chap7.html#analysing-the-iris-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How would you analyse these data? Since we have 3 distinct groups (species) to compare and the data are continuous and (probably) normally-distributed, the Analysis of Variance (ANOVA) might be your first choice. Here is an analysis for petal length in R:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="chap7.html#cb76-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb76-2"><a href="chap7.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Species       2  437.1  218.55    1180 &lt;2e-16 ***
## Residuals   147   27.2    0.19                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We see that there is evidence for significant variation in petal length among species. We reject the null hypothesis that there are no differences in petal length among the three species. Note that this is a very vague conclusion. We don’t know which species differ in their petal length from the others, and we don’t know how big the differences really are. A thorough analysis would establish this information.</p>
</div>
<div id="model-diagnostics" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Model Diagnostics<a href="chap7.html#model-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When building a statistical model, checking the model using diagnostic plots is a crucial step. All models have assumptions and if these assumptions are violated then the model will potentially give wrong results. For the ANOVA model, there are several important assumptions:</p>
<ul>
<li>The data are independent</li>
<li>The residuals follow a Normal distribution</li>
<li>The variance of the residuals is constant over the range of the data (homoscedastic errors).</li>
</ul>
<p>While all three assumptions are important, the first and third are crucial. It turns out that the Normality of residuals is not an overly strong assumption for the ANOVA model, but you should still check it, as large departures from Normality can cause problems. I usually rely on graphical approaches to testing assumptions:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chap7.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb78-2"><a href="chap7.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="BIOL3360_files/figure-html/unnamed-chunk-43-1.png" width="768" /></p>
<p>The first diagnostic plot above, plots the residuals versus their fitted values. If the assumption of homoscedasticity holds (try saying that 5 times fast!), there will be no pattern to the residuals. If you see a curve, either upwards or downwards, that is suggestive of curvature in your data. If there is a “trumpet” like effect either increasing to the right or left, or you have a “bow tie” shape to the residual plot ie narrower in the middle, then the data are not homoscedastic.</p>
<p>Subset and Recode the Data}</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chap7.html#cb79-1" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">!=</span> <span class="st">&quot;setosa&quot;</span>)</span></code></pre></div>
<p>Hypothesis: There exists a difference between the species’ means. How would you analyse these data?
- t-test?
- ANOVA?
- Regression?
- All three!!!</p>
</div>
<div id="analysis-using-t-test" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Analysis using t test<a href="chap7.html#analysis-using-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="chap7.html#cb80-1" aria-hidden="true" tabindex="-1"></a>fit.ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Petal.Length <span class="sc">~</span> Species, </span>
<span id="cb80-2"><a href="chap7.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> iris2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-3"><a href="chap7.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.ttest)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  Petal.Length by Species
## t = -12.604, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group versicolor and group virginica is not equal to 0
## 95 percent confidence interval:
##  -1.495426 -1.088574
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    4.260                    5.552</code></pre>
</div>
<div id="analysis-using-anova" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Analysis using ANOVA<a href="chap7.html#analysis-using-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chap7.html#cb82-1" aria-hidden="true" tabindex="-1"></a>fit.anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris2)</span>
<span id="cb82-2"><a href="chap7.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.anova)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Species      1  41.73   41.73   158.9 &lt;2e-16 ***
## Residuals   98  25.74    0.26                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="analysis-using-regression" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Analysis using Regression<a href="chap7.html#analysis-using-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chap7.html#cb84-1" aria-hidden="true" tabindex="-1"></a>fit.regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris2)</span>
<span id="cb84-2"><a href="chap7.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.regression)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length ~ Species, data = iris2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.260 -0.360  0.044  0.340  1.348 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       4.26000    0.07248   58.77   &lt;2e-16 ***
## Speciesvirginica  1.29200    0.10251   12.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5125 on 98 degrees of freedom
## Multiple R-squared:  0.6185, Adjusted R-squared:  0.6146 
## F-statistic: 158.9 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="points-to-note" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Points to Note<a href="chap7.html#points-to-note" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>For an F test with <strong>one</strong> degree of freedom in the numerator, <span class="math inline">\(F = t^2\)</span> with the denominator degrees of freedom for the F statistic equal to the degrees of freedom for the t statistic.
We can get the regression output from the ANOVA fit using <code>summary.lm</code></li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="chap7.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(fit.anova)</span></code></pre></div>
<pre><code>## 
## Call:
## aov(formula = Petal.Length ~ Species, data = iris2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.260 -0.360  0.044  0.340  1.348 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       4.26000    0.07248   58.77   &lt;2e-16 ***
## Speciesvirginica  1.29200    0.10251   12.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5125 on 98 degrees of freedom
## Multiple R-squared:  0.6185, Adjusted R-squared:  0.6146 
## F-statistic: 158.9 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Regression Plot</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chap7.html#cb88-1" aria-hidden="true" tabindex="-1"></a>iris2<span class="sc">$</span>coded <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris2<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb88-2"><a href="chap7.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb88-3"><a href="chap7.html#cb88-3" aria-hidden="true" tabindex="-1"></a>mns <span class="ot">&lt;-</span> <span class="fu">tapply</span>(iris2<span class="sc">$</span>Petal.Length, iris2<span class="sc">$</span>coded, mean)</span>
<span id="cb88-4"><a href="chap7.html#cb88-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Petal.Length =</span> mns, <span class="at">coded =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">lower=</span><span class="fu">c</span>(<span class="cn">NA</span>, mns[<span class="dv">1</span>]), <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">NA</span>, mns[<span class="dv">2</span>]))</span>
<span id="cb88-5"><a href="chap7.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris2, <span class="fu">aes</span>(coded, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb88-6"><a href="chap7.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb88-7"><a href="chap7.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> lm , <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula=</span>y<span class="sc">~</span>x) <span class="sc">+</span></span>
<span id="cb88-8"><a href="chap7.html#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_errorbar</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> coded, <span class="at">ymin =</span> lower, </span>
<span id="cb88-9"><a href="chap7.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fl">2.5</span>, <span class="fl">7.5</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-10"><a href="chap7.html#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>])), <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb88-11"><a href="chap7.html#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>])), <span class="at">x =</span> <span class="fl">0.95</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb88-12"><a href="chap7.html#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">expression</span>(beta[<span class="dv">0</span>])), <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="dv">4</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb88-13"><a href="chap7.html#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">expression</span>(height <span class="sc">==</span> beta[<span class="dv">0</span>] <span class="sc">+</span> beta[<span class="dv">1</span>] <span class="sc">%*%</span> Species)), </span>
<span id="cb88-14"><a href="chap7.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">7</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="BIOL3360_files/figure-html/unnamed-chunk-49-1.png" width="480" /></p>
</div>
<div id="summary" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Summary<a href="chap7.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>If we code our categorical variables as 0, 1, then the slope <span class="math inline">\(\beta_1\)</span> is the same as the difference between the means for each category.</li>
<li>The intercept <span class="math inline">\(\beta_0\)</span> is the value for the baseline category.</li>
<li>With 3 or more categories, we construct the 0, 1 <code>dummy variables</code>:</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chap7.html#cb89-1" aria-hidden="true" tabindex="-1"></a>cat.var <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb89-2"><a href="chap7.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(<span class="sc">~</span>cat.var)</span></code></pre></div>
<pre><code>##   (Intercept) cat.varB cat.varC
## 1           1        0        0
## 2           1        1        0
## 3           1        0        1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$cat.var
## [1] &quot;contr.treatment&quot;</code></pre>
</div>
<div id="linear-models" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Linear Models<a href="chap7.html#linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Comparing groups or doing regression are examples of the General Linear Model.</li>
<li>Regression: <span class="math inline">\(y_i = \beta_0 + \beta_1x_i + \epsilon_i, \epsilon \sim NID(0, \sigma^2)\)</span></li>
<li>ANOVA: <span class="math inline">\(y_{ij} = \mu + \tau_i + \epsilon_{ij}, \epsilon \sim NID(0, \sigma^2)\)</span></li>
<li>Why ``Linear?’’ Definition: A linear transformation (equation) is defined by these 2 properties:</li>
</ul>
<p>– <span class="math inline">\(f(x + y) = f(x) + f(y)\)</span>: Additivity
– <span class="math inline">\(f(Ax) = Af(x)\)</span> : Homogeneity
– Idea: The whole is equal to the sum of its parts</p>
<p>Linear models are the workhorse of all statistical modelling. They crop up everywhere. Especially, the computational ease with which we can analyse linear models governs the procedures for the design of experiments. The reason for the use of the guidelines for the design of experiments in Chapter 6 is precisely so that we can apply a linear modelling framework to the experimental system. This is why we need to spend so much time on them. An appreciation of the mathematics is very useful for understanding their uses, similarities and differences from each other.</p>
</div>
<div id="matrix-notation-for-linear-models" class="section level2 hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> Matrix Notation for Linear Models<a href="chap7.html#matrix-notation-for-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mathematical formulation of a linear regression model (perhaps the simplest linear model) is below:</p>
<p><span class="math inline">\(Y_i= \beta_0 + \beta_1 X_i + \epsilon_i, \epsilon_i \sim NID(0, \sigma^2)\)</span></p>
<p>The <span class="math inline">\(Y_i\)</span>’s are the values of the response variable. The <span class="math inline">\(\beta\)</span>’s are the intercept and slope parameters. It is these that we would like to estimate.. <span class="math inline">\(X_i\)</span> are the data for the explanatory variable. <span class="math inline">\(\sigma^2\)</span> is the error variance: the variance of the residuals around the line. The residual is simply the distance between the data point and the fitted line, on the y axis. We can write down an equation for each data point:</p>
<p><span class="math display">\[
Y_1 = \beta_0 + \beta_1 X_1 + \epsilon_1 \\
Y_2 = \beta_0 + \beta_1 X_2 + \epsilon_2 \\
Y_3 = \beta_0 + \beta_1 X_3 + \epsilon_3 \\
\vdots \qquad \vdots \qquad \vdots \\
Y_n = \beta_0 + \beta_1 X_n + \epsilon_n
\]</span></p>
<p>We can form column vectors for the elements of each equation:</p>
<p><span class="math display">\[
\begin{bmatrix} Y_1 \\ Y_2 \\ Y_3 \\ \vdots \\ Y_n \end{bmatrix} =
\begin{bmatrix} \beta_0 + \beta_1X_1 \\
                \beta_0 + \beta_1X_2 \\
                \beta_0 + \beta_1X_3 \\
                \vdots \\
                \beta_0 + \beta_1X_n
\end{bmatrix} +
\begin{bmatrix} \epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \vdots \\ \epsilon_n \end{bmatrix}
\]</span></p>
</div>
<div id="matrix-representation" class="section level2 hasAnchor" number="7.12">
<h2><span class="header-section-number">7.12</span> Matrix Representation<a href="chap7.html#matrix-representation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can then factor out the <span class="math inline">\(\beta\)</span> terms from the middle vector.</p>
<p><span class="math display">\[
\begin{bmatrix} Y_1 \\ Y_2 \\ Y_3 \\ \vdots \\ Y_n \end{bmatrix} =
\begin{bmatrix} 1 &amp; X_1 \\ 1 &amp; X_2 \\ 1 &amp; X_3 \\ \vdots &amp; \vdots \\ 1 &amp; X_n \end{bmatrix} \times
\begin{bmatrix} \beta_0 \\ \beta_1 \end{bmatrix} +
\begin{bmatrix} \epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \vdots \\ \epsilon_n \end{bmatrix}
\]</span>
We can then write down the matrix equation for the linear model:</p>
<p><span class="math display">\[
\mathbf{Y}= \mathbf{X}\mathbf{\beta}+\mathbf{\epsilon}
\]</span>
<span class="math display">\[
\mathbf{X}= \begin{bmatrix}
    1 &amp; X_1 \\
    1 &amp; X_2 \\
    1 &amp; X_3 \\
    \vdots &amp; \vdots \\
    1 &amp; X_n \end{bmatrix} \mathbf{\beta} = \begin{bmatrix} \beta_0 \\ \beta_1 \end{bmatrix} \mathbf{\epsilon} = \begin{bmatrix}
\epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \vdots \\ \epsilon_n \end{bmatrix} \mathbf{Y} = \begin{bmatrix}
Y_1 \\ Y_2 \\ Y_3 \\ \vdots \\ Y_n \end{bmatrix}
\]</span>
Here we have <span class="math inline">\(\mathbf{X}\)</span> which is called the <strong>design matrix</strong>. <span class="math inline">\(\beta\)</span> is the <strong>vector of parameters</strong> (to be estimated). <span class="math inline">\(\mathbf{\epsilon}\)</span> is the <strong>vector of errors</strong>. <span class="math inline">\(\mathbf{Y}\)</span> is the <strong>vector of responses</strong>. In this, the General Linear Model, <span class="math inline">\(\mathbf{X}\)</span> can have more than 2 columns. The first column is usually a vector of 1’s (corresponding to the intercept). The other columns contain the explanatory variables, which may be continuous (leading to <strong>multiple regression</strong>) or discrete (usually 0, 1), leading to the <strong>Analysis of Variance</strong> (ANOVA). Mixtures of continuous and discrete explanatory variables lead to the <strong>Analysis of Covariance</strong> (ANCOVA) and other more complicated models.</p>
</div>
<div id="distributional-assumptions" class="section level2 hasAnchor" number="7.13">
<h2><span class="header-section-number">7.13</span> Distributional Assumptions<a href="chap7.html#distributional-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we have to specify the assumptions regarding the statistical distribution of the residuals. This will usually be one number, specifying that the variance of residuals, given the symbol <span class="math inline">\(\sigma^2\)</span>. If we want to specify the variance for each data value, we can write:</p>
<p><span class="math display">\[
\sigma^2_\epsilon = \sigma^2\mathbf{I} = \begin{bmatrix}
\sigma^2 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \sigma^2 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \sigma^2
\end{bmatrix}
\]</span>
where <span class="math inline">\(\mathbf{I}\)</span> is the identity matrix. Thus, each data point has a variance of <span class="math inline">\(\sigma^2\)</span> and the off-diagonals are all zero, signifying that there is <strong>no correlation</strong> between the data points. We can write this as:
<span class="math display">\[
\epsilon \sim N(0, \sigma^2\mathbf{I})
\]</span>
We say that the epsilons (<span class="math inline">\(\mathbf{\epsilon}\)</span>) are <strong>distributed as</strong> following a Normal distribution, with zero mean and variance <span class="math inline">\(\sigma^2\mathbf{I}\)</span>. <strong>N</strong> is the usual symbol for the Normal distribution and the “~” means “is distributed as.”</p>
<p>This leads to the Full model:</p>
<p><span class="math inline">\(\Huge\textbf{Y} = \mathbf{X\beta} + \mathbf{\epsilon}, \quad \mathbf{\epsilon} \sim N(0, \sigma^2\mathbf{I})\)</span></p>
<p><strong>This equation is worth remembering.</strong></p>
</div>
<div id="estimation-ordinary-least-squares" class="section level2 hasAnchor" number="7.14">
<h2><span class="header-section-number">7.14</span> Estimation: Ordinary Least Squares<a href="chap7.html#estimation-ordinary-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We wish to estimate <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma^2\)</span>. This is usually done by the method of Ordinary Least Squares (OLS). The derivation of these estimators is beyond the scope of the course. You may have seen the formula for <span class="math inline">\(\hat{\beta}\)</span> before: it was the last exercise in the matrix problem sheet.
<span class="math display">\[
\hat{\beta} = (\mathbf{X^TX})^{-1}\mathbf{X^T} \mathbf{Y} \\
\hat{\sigma^2} = \frac{1}{n - p}(\mathbf{Y} - \mathbf{X\hat{\beta}})^T (\mathbf{Y} - \mathbf{X\hat{\beta}})
\]</span>
where <span class="math inline">\(\hat{\sigma}^2\)</span> is the unbiased estimator of <span class="math inline">\(\sigma^2\)</span>, and <span class="math inline">\(p=2\)</span> in the situation where we are estimating the slope and the intercept. <span class="math inline">\(n\)</span> is the sample size.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
