<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Effect sizes and uncertainty | BIOL3360</title>
  <meta name="description" content="6 Effect sizes and uncertainty | BIOL3360" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Effect sizes and uncertainty | BIOL3360" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Effect sizes and uncertainty | BIOL3360" />
  
  
  

<meta name="author" content="Simone Blomberg" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap5.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="shortcut icon" href="pics/favicon.ico">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://shire.science.uq.edu.au/QBIOL/">QBIO Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to BIOL3360!</a></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> BIOL3360: Analysis and Communication of Biological Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#course-description"><i class="fa fa-check"></i><b>1.1</b> Course description</a></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#course-delivery"><i class="fa fa-check"></i><b>1.2</b> Course Delivery</a></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#textbooks-and-resources"><i class="fa fa-check"></i><b>1.3</b> Textbooks and Resources</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#assessment"><i class="fa fa-check"></i><b>1.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5" data-path="chap1.html"><a href="chap1.html#goals-and-expectations"><i class="fa fa-check"></i><b>1.5</b> Goals and expectations</a></li>
<li class="chapter" data-level="1.6" data-path="chap1.html"><a href="chap1.html#course-communication"><i class="fa fa-check"></i><b>1.6</b> Course communication</a></li>
<li class="chapter" data-level="1.7" data-path="chap1.html"><a href="chap1.html#and-finally"><i class="fa fa-check"></i><b>1.7</b> And finally…</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> Week 1: R Programming I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#why-programming-why-statistics-why-r"><i class="fa fa-check"></i><b>2.1</b> Why Programming? Why Statistics? Why R?</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#why-statistics"><i class="fa fa-check"></i><b>2.2</b> Why Statistics?</a></li>
<li class="chapter" data-level="2.3" data-path="chap2.html"><a href="chap2.html#why-r"><i class="fa fa-check"></i><b>2.3</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> Beginning R Programming</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#the-workspace-setup"><i class="fa fa-check"></i><b>3.1</b> The Workspace Setup</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#first-steps"><i class="fa fa-check"></i><b>3.2</b> First steps</a></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#the-art-of-r-programming"><i class="fa fa-check"></i><b>3.3</b> The Art of R Programming</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> More R Programming</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#more-on-data-structures"><i class="fa fa-check"></i><b>4.1</b> More on Data Structures</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#lists"><i class="fa fa-check"></i><b>4.2</b> Lists</a></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#data-frames"><i class="fa fa-check"></i><b>4.3</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> Flow of Control</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#loops"><i class="fa fa-check"></i><b>5.1</b> Loops</a></li>
<li class="chapter" data-level="5.2" data-path="chap5.html"><a href="chap5.html#for-loops"><i class="fa fa-check"></i><b>5.2</b> For loops</a></li>
<li class="chapter" data-level="5.3" data-path="chap5.html"><a href="chap5.html#while-and-repeat"><i class="fa fa-check"></i><b>5.3</b> while and repeat</a></li>
<li class="chapter" data-level="5.4" data-path="chap5.html"><a href="chap5.html#branching-code-the-if-then-else-construct."><i class="fa fa-check"></i><b>5.4</b> Branching code: The if-then-else construct.</a></li>
<li class="chapter" data-level="5.5" data-path="chap5.html"><a href="chap5.html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> Effect sizes and uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap6.html"><a href="chap6.html#effect-sizes"><i class="fa fa-check"></i><b>6.1</b> Effect sizes</a></li>
<li class="chapter" data-level="6.2" data-path="chap6.html"><a href="chap6.html#uncertainty"><i class="fa fa-check"></i><b>6.2</b> Uncertainty</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chap6.html"><a href="chap6.html#standard-errors-and-confidence-intervals"><i class="fa fa-check"></i><b>6.2.1</b> Standard errors and confidence intervals</a></li>
<li class="chapter" data-level="6.2.2" data-path="chap6.html"><a href="chap6.html#a-practical-example"><i class="fa fa-check"></i><b>6.2.2</b> A practical example</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL3360</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap6" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Effect sizes and uncertainty<a href="chap6.html#chap6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="effect-sizes" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Effect sizes<a href="chap6.html#effect-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Null hypothesis significance testing (NHST), as covered in the previous chapter, emphasizes conclusions based on the presence vs. absence of an effect, according to a more-or-less arbitrary ‘significance-level’ defined by the <em>p</em>-value.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>But it is just as - if not more important - to remember that the parameters you have estimated, and the relationship they describe, actually mean something. So rather than (or in addition to) hypothesis testing, you can use your parameter estimates, and estimates of uncertainty in your parameter estimates, to draw conclusions about how the world works.</p>
<p>Let’s model the association between height and weight using for the iKung San people again, and look at the estimates of the coefficients:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chap6.html#cb50-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> height <span class="sc">~</span> weight, <span class="at">data=</span>d2)</span>
<span id="cb50-2"><a href="chap6.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(m1)</span></code></pre></div>
<pre><code>## (Intercept)      weight 
## 113.8793936   0.9050291</code></pre>
<p>The coefficient ‘weight’ describes the strength of the relationship between ‘weight’ (our predictor variable) and height (our response variable). Because weight is measured in kg and height is measured in cm, we can say that height increases with weight at a rate of 0.905 cm of additional height for every 1kg of additional weight. So, you don’t need to focus on <em>p</em>-values and tests of statistical significance. You can focus on <em>effect sizes</em>. Some argue that estimation of biologically-relevant parameters and (relatedly) effect sizes, and their biological (rather than statistical) significance are more important than hypothesis testing. Either way, estimation of effect sizes and hypothesis testing are not mutually exclusive and regardless of whether you ‘do’ hypothesis testing, you should always (also) focus on effect sizes.</p>
</div>
<div id="uncertainty" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Uncertainty<a href="chap6.html#uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many ways our ‘point’ estimates of the model coefficients (extracted using <code>coefficients(model)</code>) are our ‘statistical best guesses’. But they are far from certain. In fact unless you are sampling the entire population (in which case you are not ‘sampling’) and measuring things perfectly then your point estimates ARE CERTAINLY WRONG. So we should not place too much weight on our parameter estimates without also quantifying our uncertainty in those estimates.</p>
<div id="standard-errors-and-confidence-intervals" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Standard errors and confidence intervals<a href="chap6.html#standard-errors-and-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formal expressions of uncertainty in our estimates are often expressed as confidence intervals around our estimates (at least for Frequentist [cf. Bayesian] methods). Confidence intervals are derived from the standard error of the estimate. What is a standard error, how does the standard error relate to a confidence interval, and how should a confidence interval be interpreted?</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LAujBMcUvZU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</center>
<p><br />
</p>
<center>
<img src="pics/normal_distribution.png" style="width:85.0%" />
</center>
<p><br />
</p>
</div>
<div id="a-practical-example" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> A practical example<a href="chap6.html#a-practical-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will (maybe) use some different examples in coming chapters! But for now, we are sticking with our exploration of the association between weight and height. Using this example, how do we calculate confidence (and prediction) intervals on parameters and on the fitted regression line in R? Once you know how to do this, you should be able to apply these methods more generally.</p>
<p>The formula for a confidence interval for an estimate, where the sampling distribution of the estimate is described by a <em>t</em>-distribution is:</p>
<p><span class="math inline">\(\hat\beta\pm t_{1-\textrm{alpha}/2,\textrm{df}}\times\sigma_{\hat\beta}\)</span></p>
<p>where alpha is equal to the ‘significance’ level, and df is equal to the residual degrees of freedome (<span class="math inline">\(n-k\)</span>). To generate a 95% CI, alpha = 0.05. To generate a 71% CI, alpha = 0.29. But why don’t we let R do the work:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chap6.html#cb52-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> height <span class="sc">~</span> weight, <span class="at">data=</span>d2)</span>
<span id="cb52-2"><a href="chap6.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="chap6.html#cb52-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb52-4"><a href="chap6.html#cb52-4" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">-</span> (<span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,m1<span class="sc">$</span>df.residual)) <span class="sc">*</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># lower</span></span></code></pre></div>
<pre><code>##    weight 
## 0.8223315</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chap6.html#cb54-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">+</span> (<span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,m1<span class="sc">$</span>df.residual)) <span class="sc">*</span> <span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>] <span class="co"># upper</span></span></code></pre></div>
<pre><code>##    weight 
## 0.9877267</code></pre>
<p><span style="color: red;"><strong>Exercise</strong></span> Work through the syntax to calculate the upper and lower bounds of the CI above to ‘decipher’ each term. What is <code>qt()</code> and what are its arguments? Why do we use <code>qt()</code> (the mini-lecture should help here). How did I extract the standard error of the coefficient?</p>
<p>Of course we can also use a convenient shortcut in R:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chap6.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code></pre></div>
<pre><code>##                   2.5 %      97.5 %
## (Intercept) 110.1207774 117.6380098
## weight        0.8223315   0.9877267</code></pre>
<p>You can see that our ‘long-cut’ and R’s shortcut both give the same upper and lower bounds of the 95% CI.</p>
<p>As shown in the mini-lecture, we can also generate confidence intervals around the regression line (rather than just on individual coefficients such as the intercept and slope). Confidence intervals around the regression line account for uncertainty in <span class="math inline">\(\hat{y}\)</span> for each <span class="math inline">\(x_i\)</span></p>
<p>To do this in R is straightforward. First create a dataframe of new ‘weight’ values for which we would like to predict height values based on the fitted model, and for which we would like to generate CIs:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chap6.html#cb58-1" aria-hidden="true" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">weight=</span><span class="fu">seq</span>(<span class="fu">min</span>(d2<span class="sc">$</span>weight),<span class="fu">max</span>(d2<span class="sc">$</span>weight),<span class="at">length.out=</span><span class="dv">400</span>))</span>
<span id="cb58-2"><a href="chap6.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdat)</span></code></pre></div>
<pre><code>##     weight
## 1 31.07105
## 2 31.15106
## 3 31.23106
## 4 31.31106
## 5 31.39107
## 6 31.47107</code></pre>
<p><br />
Now use the <code>predict()</code> command to predict new values of height (according to the fitted model), and to generate confidence intervals, using the argument <code>interval ="c"</code></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chap6.html#cb60-1" aria-hidden="true" tabindex="-1"></a>predCI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(m1,<span class="at">newdata =</span> newdat,<span class="at">interval =</span> <span class="st">&quot;c&quot;</span>))</span>
<span id="cb60-2"><a href="chap6.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predCI)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 141.9996 140.7310 143.2682
## 2 142.0720 140.8094 143.3346
## 3 142.1444 140.8878 143.4010
## 4 142.2168 140.9662 143.4674
## 5 142.2892 141.0446 143.5339
## 6 142.3616 141.1230 143.6003</code></pre>
<p><br />
And finally, plot the results:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chap6.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height<span class="sc">~</span>weight,<span class="at">data =</span> d2)</span>
<span id="cb62-2"><a href="chap6.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>fit<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add fitted/predicted line</span></span>
<span id="cb62-3"><a href="chap6.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>lwr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for lower bound on CI</span></span>
<span id="cb62-4"><a href="chap6.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>upr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for upper bound on CI</span></span></code></pre></div>
<p><img src="QBIO7005_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Note that the confidence interval provides information on the precision of our estimate of the fitted line. Being able to predict brand new <em>observations</em> of height in a new sample from the population is something different - a prediction interval, which gives the interval for which we have a certain level of confidence that, say, 95% of new observations from the population will fall within:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="chap6.html#cb63-1" aria-hidden="true" tabindex="-1"></a>predPI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(m1,<span class="at">newdata =</span> newdat,<span class="at">interval =</span> <span class="st">&quot;p&quot;</span>))</span>
<span id="cb63-2"><a href="chap6.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predPI)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 141.9996 131.9159 152.0833
## 2 142.0720 131.9890 152.1550
## 3 142.1444 132.0622 152.2267
## 4 142.2168 132.1353 152.2983
## 5 142.2892 132.2085 152.3700
## 6 142.3616 132.2816 152.4417</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chap6.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(height<span class="sc">~</span>weight,<span class="at">data =</span> d2)</span>
<span id="cb65-2"><a href="chap6.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>fit<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add fitted/predicted line</span></span>
<span id="cb65-3"><a href="chap6.html#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="chap6.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence intervals</span></span>
<span id="cb65-5"><a href="chap6.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>lwr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for lower bound on CI</span></span>
<span id="cb65-6"><a href="chap6.html#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predCI<span class="sc">$</span>upr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for upper bound on CI</span></span>
<span id="cb65-7"><a href="chap6.html#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="chap6.html#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># prediction intervals</span></span>
<span id="cb65-9"><a href="chap6.html#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predPI<span class="sc">$</span>lwr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for lower bound on CI</span></span>
<span id="cb65-10"><a href="chap6.html#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predPI<span class="sc">$</span>upr<span class="sc">~</span>newdat<span class="sc">$</span>weight,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>) <span class="co"># add line for upper bound on CI</span></span></code></pre></div>
<p><img src="QBIO7005_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p><br />
How <em>confident</em> are you now in your growing statistical skills?</p>

</div>
</div>
</div>






<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>As a brief aside, when thinking about the value of NHST, you should be aware that we are not limited to testing a null hypothesis of no effect, which is almost never likely to be true anyway. In fact, using classical (Frequentist), likelihood and Bayesian methods for example, we can compare the fit of models representing different competing hypotheses. You may wonder why we didn’t just teach you this in the first place and it’s a good question. First, as pointed out in the previous chapter ANOVA is a general statistical method whose use is not limited to NHST. Second, everything you are learning should provide you with a foundation on which to build. Third, you already know about maximum likelihood estimation methods, and you know how to compare models in R using likelihood ratio tests, for example. So it might not seem like it but you are well on your way.<a href="chap6.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap5.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
